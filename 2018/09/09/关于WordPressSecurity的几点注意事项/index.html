<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="关于WordPressSecurity的几点注意事项"><meta name="keywords" content="漏洞分析"><meta name="author" content="Ginove,undefined"><meta name="copyright" content="Ginove"><title>关于WordPressSecurity的几点注意事项 | Ginove</title><link rel="shortcut icon" href="https://ginove-1252770243.cos.ap-guangzhou.myqcloud.com/%E8%B7%AF%E9%A3%9E/bitbug_favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"CH3QQ87I9H","apiKey":"1005940df08368eb06761af10c531247","indexName":"my-hexo-blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#EventON"><span class="toc-number">1.</span> <span class="toc-text">EventON</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#漏洞"><span class="toc-number">1.0.1.</span> <span class="toc-text">漏洞</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#联系供应商"><span class="toc-number">1.0.2.</span> <span class="toc-text">联系供应商</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Google-Map-Pro"><span class="toc-number">2.</span> <span class="toc-text">Google Map Pro</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#漏洞-1"><span class="toc-number">2.0.1.</span> <span class="toc-text">漏洞</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#联系供应商-1"><span class="toc-number">2.0.2.</span> <span class="toc-text">联系供应商</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jupiter"><span class="toc-number">3.</span> <span class="toc-text">Jupiter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#漏洞-2"><span class="toc-number">3.0.1.</span> <span class="toc-text">漏洞</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#联系供应商-2"><span class="toc-number">3.0.2.</span> <span class="toc-text">联系供应商</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#媒体库助理"><span class="toc-number">4.</span> <span class="toc-text">媒体库助理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#漏洞-3"><span class="toc-number">4.0.1.</span> <span class="toc-text">漏洞</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#联系供应商-3"><span class="toc-number">4.0.2.</span> <span class="toc-text">联系供应商</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#结论"><span class="toc-number">5.</span> <span class="toc-text">结论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建议"><span class="toc-number">6.</span> <span class="toc-text">建议</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://ginove-1252770243.cos.ap-guangzhou.myqcloud.com/%E8%B7%AF%E9%A3%9E/toui.jpg"></div><div class="author-info__name text-center">Ginove</div><div class="author-info__description text-center">Keep optimistic and Never give up</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">23</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">7</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://api.dujin.org/bing/1920.php)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Ginove</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/about">About</a></span></div><div id="post-info"><div id="post-title">关于WordPressSecurity的几点注意事项</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-09</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>我们先来看看<a href="https://insinuator.net/2018/08/a-few-notes-on-wordpress-security/" target="_blank" rel="noopener">WordPress的CVE列表</a>，大多数漏洞都不是在WordPressCore里面找到的，而是在第三方插件和主题中。</p>
<p>今天，我们来谈谈WordPress。</p>
<p>对WordPress进行评估可能看起来无聊至极，因为核心功能[已测试]和配置是不允许大范围的安全性错误配置存在的。幸运的是，大多数实例使用的是插件和主题来添加WordPress核心程序尚未提供的功能。<br><a id="more"></a><br>在这篇博文中，我想讨论一下我的发现以及发现它们的方法。此外，我将描述不同厂商的响应情况，从完全没有反应、不理解问题到作出既快速又专业的反应，并要求对准备部署的更新的代码进行审查。</p>
<p>WordPress允许插件通过两种方式注册API路由——要么是为已经经过身份认证的calls注册前缀<code>wp_ajax_</code>，要么是为尚未经过身份认证的calls注册前缀<code>wp_ajax_nopriv_</code>(请参阅<a href="https://codex.wordpress.org/Plugin_API/Action_Reference/wp_ajax_%28action%29" target="_blank" rel="noopener">API插件</a>)</p>
<h3 id="EventON"><a href="#EventON" class="headerlink" title="EventON"></a><strong>EventON</strong></h3><p>EventON提供了一个日历插件作为核心和多个附加插件以扩展它的功能，包括预订、RSS订阅、票务系统、审查系统和CSV文件导入。</p>
<p>评估的系统仅安装了核心程序和CSV导入程序，但这两个插件都有漏洞，接下来我们会进行讨论。</p>
<h5 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a><strong>漏洞</strong></h5><p>首先，我们来看看eventON的核心插件。使用下面的代码可以为<code>evo_mdt</code>AJAX操作注册一个处理程序：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add_action( &apos;wp_ajax_evo_mdt&apos;, array( $this, &apos;evomdt_ajax&apos; ) );</span><br><span class="line">add_action( &apos;wp_ajax_nopriv_evo_mdt&apos;, array( $this, &apos;evomdt_ajax&apos; ) );</span><br></pre></td></tr></table></figure></p>
<p>快速查看<code>evomdt_ajax</code>函数，可以看到它将未经验证的POST数据传递给了<code>mdt_form</code>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function evomdt_ajax()&#123;</span><br><span class="line">  if(empty($_POST[&apos;type&apos;])) return;</span><br><span class="line"></span><br><span class="line">  $type = $_POST[&apos;type&apos;];</span><br><span class="line">  $output = &apos;&apos;;</span><br><span class="line"></span><br><span class="line">  switch($type)&#123;</span><br><span class="line">  case &apos;newform&apos;:</span><br><span class="line">    echo json_encode(array(</span><br><span class="line">      &apos;content&apos; =&gt;$this-&gt;mdt_form($_POST[&apos;eventid&apos;], $_POST[&apos;tax&apos;]),</span><br><span class="line">      &apos;status&apos;=&gt;&apos;good&apos;</span><br><span class="line">    )); exit;</span><br><span class="line">  break;</span><br><span class="line">  case &apos;editform&apos;:</span><br><span class="line">    echo json_encode(array(</span><br><span class="line">      &apos;content&apos; =&gt;$this-&gt;mdt_form($_POST[&apos;eventid&apos;], $_POST[&apos;tax&apos;],$_POST[&apos;termid&apos;] ),</span><br><span class="line">      &apos;status&apos;=&gt;&apos;good&apos;</span><br><span class="line">    )); exit;</span><br><span class="line">  break;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>函数<code>mdt_form</code>创建了一个反映AJAX请求中特定的POST参数的HTML输出。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function mdt_form($eventid, $tax, $termid = &apos;&apos;)&#123;</span><br><span class="line">	ob_start();			</span><br><span class="line">	?&gt;</span><br><span class="line">	&lt;div class=&apos;ev_admin_form&apos;&gt;</span><br><span class="line">		&lt;div class=&apos;evo_tax_entry evoselectfield_saved_data  sections&apos;&gt;</span><br><span class="line">		&lt;input type=&quot;hidden&quot; class=&apos;field&apos; name=&apos;eventid&apos; value=&apos;&lt;?php echo $eventid;?&gt;&apos;/&gt;</span><br><span class="line">		&lt;input type=&quot;hidden&quot; class=&apos;field&apos; name=&apos;termid&apos; value=&apos;&lt;?php echo $termid;?&gt;&apos;/&gt;</span><br><span class="line">		&lt;input type=&quot;hidden&quot; class=&apos;field&apos; name=&apos;tax&apos; value=&apos;&lt;?php echo $tax;?&gt;&apos;/&gt;</span><br><span class="line">  [...]</span><br><span class="line">	return ob_get_clean();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在没有选项参数的情况下使用<code>json_encode</code>函数，会导致PHP不会转义其他字符（参见<a href="http://php.net/manual/en/json.constants.php#constant.json-hex-tag" target="_blank" rel="noopener">JSON_HEX_TAG</a>）。因此，我们可以将任意HTML注入到响应中，但是没有浏览器会在JSON响应中评估HTML吗？好吧，只有当您的JSON响应告诉浏览器它实际上就是JSON的时候才会评估。</p>
<p>HTTP/1.1 200 OK<br>[…]<br>Content-Type: text/html; charset=UTF-8</p>
<p>{“content”:[…]</p>
<p>我是怎么找到这个漏洞的呢？我就不多卖关子了。</p>
<p>首先，让我们来看看所有已经注册的AJAX操作：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -rain &quot;add_action([ ]*[&apos;\&quot;]wp_ajax_&quot;</span><br></pre></td></tr></table></figure></p>
<p>这使我们对可用的特权和非特权行为有一个相当好的概述。快速查看处理程序可能会显示如上面所描述的漏洞。</p>
<p>我们来看看CSV导入器。由于插件目的是创建新的事件，因此对用户访问应该进行授权限制。使用上面提到的grep命令，可以得到以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ grep -rain &quot;add_action([ ]*[&apos;\&quot;]wp_ajax_&quot;</span><br><span class="line">includes/class-ajax.php:13: add_action( &apos;wp_ajax_&apos;.  $ajax_event, array( $this, $class ) );</span><br><span class="line">includes/class-ajax.php:14: add_action( &apos;wp_ajax_nopriv_&apos;.  $ajax_event, array( $this, $class ) );</span><br></pre></td></tr></table></figure></p>
<p>有趣的是，插件注册了一个<code>wp_ajax_nopriv</code>操作。检查代码发现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ajax_events = array(</span><br><span class="line">	&apos;evocsv_001&apos;=&gt;&apos;evocsv_001&apos;,</span><br><span class="line">);</span><br><span class="line">foreach ( $ajax_events as $ajax_event =&gt; $class ) &#123;</span><br><span class="line">	add_action( &apos;wp_ajax_&apos;.  $ajax_event, array( $this, $class ) );</span><br><span class="line">	add_action( &apos;wp_ajax_nopriv_&apos;.  $ajax_event, array( $this, $class ) );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以及处理函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public function evocsv_001()&#123;</span><br><span class="line"></span><br><span class="line">	if(!is_admin()) exit;</span><br><span class="line"></span><br><span class="line">	if(!isset($_POST[&apos;events&apos;]))&#123;</span><br><span class="line">		[...]</span><br><span class="line">		exit;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		[...]</span><br><span class="line">		foreach($event_data as $event)&#123;</span><br><span class="line">			[...]</span><br><span class="line">			$status = $eventon_csv-&gt;admin-&gt;import_event($processedDATA);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	[...]</span><br><span class="line">	echo json_encode($return_content);</span><br><span class="line">	exit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>有趣的是，代码确实使用<code>is_admin()</code>函数对管理员身份是否属实进行了核查，所以这个请求应该是安全的，对吗？我们来看一下<a href="https://developer.wordpress.org/reference/functions/is_admin/" target="_blank" rel="noopener">文档</a>：</p>
<blockquote>
<p>Whether the current request is for an administrative interface page. […] Does not check if the user is an administrator; current_user_can() for checking roles and capabilities.</p>
</blockquote>
<p>由于WordPress中的AJAX动作是通过<code>wp-admin/admin-ajax.php</code>文件访问的，所以<code>is_admin()</code>总是返回<code>true</code>。</p>
<p>这个插件能允许任何没有身份验证的用户在您的WordPress实例上创建事件。</p>
<p>另一个有用的grep行是搜索<code>$_GET</code>和<code>$_POST</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -rain &quot;\\$_\(GET\|POST\)&quot;</span><br></pre></td></tr></table></figure></p>
<p>快速检查CSV导入程序会发现另一个可能存在的漏洞<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ grep -rain &quot;\\$_\(GET\|POST\)&quot;</span><br><span class="line">[...]</span><br><span class="line">includes/class-settings.php:33:  $_POST[&apos;settings-updated&apos;]=&apos;Successfully updated values.&apos;;</span><br><span class="line">includes/class-settings.php:53:  $updated_code = (isset($_POST[&apos;settings-updated&apos;]))? &apos;&lt;div class=&quot;updated fade&quot;&gt;&lt;p&gt;&apos;.$_POST[&apos;settings-updated&apos;].&apos;&lt;/p&gt;&lt;/div&gt;&apos;:null;</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure></p>
<p>为了验证这一行是易受攻击的，我们看一下文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[...]</span><br><span class="line">if( isset($_POST[&apos;evocsv_noncename&apos;]) &amp;&amp; isset( $_POST ) )&#123;</span><br><span class="line">  if ( wp_verify_nonce( $_POST[&apos;evocsv_noncename&apos;], AJDE_EVCAL_BASENAME ) )&#123;</span><br><span class="line">    [...]</span><br><span class="line">    $_POST[&apos;settings-updated&apos;]=&apos;Successfully updated values.&apos;;</span><br><span class="line">[...]</span><br><span class="line">$updated_code = (isset($_POST[&apos;settings-updated&apos;]))? &apos;&lt;div class=&quot;updated fade&quot;&gt;&lt;p&gt;&apos;.$_POST[&apos;settings-updated&apos;].&apos;&lt;/p&gt;&lt;/div&gt;&apos;:null;</span><br><span class="line">echo $updated_code;</span><br></pre></td></tr></table></figure></p>
<p>我们可以看到，如果请求中的临时参数没有设置或者是无效的，那么如果设置了，POST参数就会被反射。这就是为什么不应该使用POST变量来存储应用程序数据。</p>
<h5 id="联系供应商"><a href="#联系供应商" class="headerlink" title="联系供应商"></a><strong>联系供应商</strong></h5><p>悲剧的是，我们没有收到供应商的任何回复。</p>
<h3 id="Google-Map-Pro"><a href="#Google-Map-Pro" class="headerlink" title="Google Map Pro"></a><strong>Google Map Pro</strong></h3><p>顾名思义，Google Map Pro将谷歌地图集成到WordPress页面。</p>
<h5 id="漏洞-1"><a href="#漏洞-1" class="headerlink" title="漏洞"></a><strong>漏洞</strong></h5><p>这个漏洞是通过下面的grep行找到的，grep行基本功能是搜索已打开的标签（PHP或HTML），后面跟着变量的回显。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -rain &quot;]*echo[ ]\&#123;1,\&#125;\\$&quot;</span><br></pre></td></tr></table></figure></p>
<p>现在的输出应该包含变量被写入响应中的大多数事件。最后，我在我的输出中找到了下面的行：</p>
<p>core/class.plugin-overview.php:165: <div class=" flippercode-ui fcdoc-product-info" data-current-product="productTextDomain;" ?=""> data-current-product-slug=productSlug; ?&gt; data-product-version = productVersion; ?&gt; data-product-name = “productName; ?&gt;” &gt;</div></p>
<p>快速检查一下回显变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$skin = $_GET[&apos;skin&apos;];</span><br></pre></td></tr></table></figure></p>
<p>使用此参数，攻击者可以伪造包含简单有效负载的链接，以在管理员的上下文中执行JavaScript。</p>
<h5 id="联系供应商-1"><a href="#联系供应商-1" class="headerlink" title="联系供应商"></a><strong>联系供应商</strong></h5><p>供应商确实联系了我们说漏洞已经修复，还说漏洞并不重要，因为只有管理门户受到了影响！？</p>
<h3 id="Jupiter"><a href="#Jupiter" class="headerlink" title="Jupiter"></a>Jupiter</h3><p><a href="https://themes.artbees.net/pages/jupiter-wordpress-theme-create-wordpress-websites/" target="_blank" rel="noopener">Jupiter</a>是WordPress的一个主题，它具有一个WYSIWYG编辑器的页面元素。</p>
<h5 id="漏洞-2"><a href="#漏洞-2" class="headerlink" title="漏洞"></a><strong>漏洞</strong></h5><p>为了在我们的grep输出中展示这个漏洞，我们修改正则表达式，使之包含将字符串与变量连接起来的回显。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -rain &quot;echo \(\([&apos;][^&apos;]*[&apos;]\|[\&quot;][^\&quot;]*[\&quot;]\)[ ]*.[ ]*\)*\\$&quot;</span><br></pre></td></tr></table></figure></p>
<p>从这一点来看，如果它们被污染（包含用户控制的输入），则必须检查所有级联变量。使用给定的命令多行输出POST请求的元数据的行为是可以被识别的。将元数据设置为适合的payload，编辑器就可以在显示博客帖子时执行JavaScript代码，而不会在管理界面中显示。</p>
<h5 id="联系供应商-2"><a href="#联系供应商-2" class="headerlink" title="联系供应商"></a><strong>联系供应商</strong></h5><p>Artbees响应确实迅速，并且提供了一个PHP文件补丁供我们检查。经过一些细微的调整后，我们确定的漏洞已经修复好了。</p>
<h3 id="媒体库助理"><a href="#媒体库助理" class="headerlink" title="媒体库助理"></a><strong>媒体库助理</strong></h3><p>这是<a href="Media Library Assistant">媒体库助理</a>插件</p>
<h5 id="漏洞-3"><a href="#漏洞-3" class="headerlink" title="漏洞"></a><strong>漏洞</strong></h5><p>在插件选项站点的包含文档中使用反射的GET参数，攻击者可以伪造链接，从而使任意HTML（以及JavaScript）被包含在管理门户中。由于插件的管理页面需要在请求中显示有效的临时随机数，因此对这个漏洞的攻击可能不切实际。</p>
<h5 id="联系供应商-3"><a href="#联系供应商-3" class="headerlink" title="联系供应商"></a><strong>联系供应商</strong></h5><p>供应商确实做出了非常快速的响应，为反馈的其他已知的漏洞进行了修复。</p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a><strong>结论</strong></h3><p>我们可以识别几乎所有已安装的WordPress实例插件中存在的漏洞。有些插件是免费的，有些不是。在非免费插件中发现了更为严重的漏洞。如前所述，安装WordPress插件可能会对整个网站产生严重的安全影响。</p>
<h3 id="建议"><a href="#建议" class="headerlink" title="建议"></a><strong>建议</strong></h3><p>由于PHP插件是作为源代码交付的，所以我建议使用<code>grep</code>来快速检查，这也许已经识别出可能存在的安全漏洞,使用的<code>grep</code>命令是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grep -rain &quot;add_action([ ]*[&apos;\&quot;]wp_ajax_&quot;</span><br><span class="line">grep -rain &quot;echo \(\([&apos;][^&apos;]*[&apos;]\|[\&quot;][^\&quot;]*[\&quot;]\)[ ]*.[ ]*\)*\\$&quot;</span><br><span class="line">grep -rain &quot;&lt;[^&gt;]*echo[ ]\&#123;1,\&#125;\\$&quot;</span><br><span class="line">grep -rain &quot;echo \(\([&apos;][^&apos;]*[&apos;]\|[\&quot;][^\&quot;]*[\&quot;]\)[ ]*.[ ]*\)*\\$&quot;</span><br></pre></td></tr></table></figure></p>
<p>也许这些可以帮助您去识别自己实例中易受攻击的WordPress插件。</p>
<hr>
<p>本文翻译自：<a href="https://insinuator.net/2018/08/a-few-notes-on-wordpress-security/" target="_blank" rel="noopener">https://insinuator.net/2018/08/a-few-notes-on-wordpress-security/</a></p>
<hr>
<p>Cheers！</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Ginove</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://ginove.github.io/2018/09/09/关于WordPressSecurity的几点注意事项/">https://ginove.github.io/2018/09/09/关于WordPressSecurity的几点注意事项/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://ginove.github.io" target="_blank">Ginove</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/漏洞分析/">漏洞分析</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/09/09/技术报告：绕过工作流保护机制-SharePoint远程代码执行/"><i class="fa fa-chevron-left">  </i><span>技术报告：绕过工作流保护机制 - SharePoint远程代码执行</span></a></div><div class="next-post pull-right"><a href="/2018/09/09/漏洞聚焦-CVE-2016-5072/"><span>漏洞聚焦: CVE-2016-5072</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2018 By Ginove</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script><script src="/js/search/algolia.js"></script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>